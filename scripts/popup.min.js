$(document).ready((function(){var activeTab;chrome.tabs.query({active:!0,currentWindow:!0},(function(tabs){activeTab=tabs[0],chrome.tabs.sendMessage(activeTab.id,{message:"getLinks"})})),chrome.runtime.sendMessage({message:"getStats"}),chrome.storage.sync.get({pattern:"*.jpg"},(function(items){$("#patternInput").val(items.pattern)})),$("#selectButton").click((function(){$("#listTable tr.link.selected").find("input.checkbox").prop("checked",!0).change()})),$("#deselectButton").click((function(){$("#listTable tr.link.selected").find("input.checkbox").prop("checked",!1).change()})),$("#startButton").click((function(){var urls=[];$("#listTable input.checkbox:checked").parent().parent().find("td.url").each((function(i,el){urls.push({u:$(el).attr("title"),t:activeTab.title})})),chrome.runtime.sendMessage({message:"addToQueue",urls:urls})})),$("#closeButton").click((function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(tabs){var activeTab=tabs[0];chrome.tabs.remove(activeTab.id)}))})),$("#reloadButton").click((function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(tabs){var activeTab=tabs[0];chrome.tabs.update(activeTab.id,{url:activeTab.url})}))})),$("#quickstartButton").click((function(){$("#patternButton").trigger("click"),setTimeout((function(){$("#startButton").trigger("click")}),500),setTimeout((function(){$("#closeButton").trigger("click")}),1e3)})),$("#patternButton").click((function(){var regexPattern=globStringToRegex($("#patternInput").val());$("#listTable td.url").each((function(i,el){var url=$(el).attr("title");null!=url&&url.toLowerCase().match(regexPattern)&&$(el).parent().find("input.checkbox").prop("checked",!0).change()}))})),$("#clearDownloads").click((function(){chrome.runtime.sendMessage({message:"clearDownloads"})}))})),chrome.runtime.onMessage.addListener((function(request,sender,sendResponse){"stats"==request.message&&($("#numDownloading").text()!=request.numDownloading&&($("#numDownloading").removeClass("statsNumberAnimated"),setTimeout((function(){$("#numDownloading").addClass("statsNumberAnimated")}),0)),$("#numQueued").text()!=request.numQueued&&($("#numQueued").removeClass("statsNumberAnimated"),setTimeout((function(){$("#numQueued").addClass("statsNumberAnimated")}),0)),$("#numFinished").text()!=request.numFinished&&($("#numFinished").removeClass("statsNumberAnimated"),setTimeout((function(){$("#numFinished").addClass("statsNumberAnimated")}),0)),$("#numDownloading").text(request.numDownloading),$("#numQueued").text(request.numQueued),$("#numFinished").text(request.numFinished)),"links"==request.message&&($("#listTable").html(""),request.links.length>0?$(request.links).each((function(i,val){var row=$('<tr class="link"><td class="checkbox"><input type="checkbox" class="checkbox"></td><td class="url"><span class="part1"></span><span class="part2"></span><span class="part3"></span></td><td class="description"></td></tr>'),match;row.find("td.description").text(val.description),(match=val.url.match(/^(.*\/)?([^\/\?]+)(\?.*)$/))?(row.find("td.url span.part2").text(match[2]),row.find("td.url span.part3").text(match[3])):(match=val.url.match(/^(.*\/)?([^\/\?]+)$/))?row.find("td.url span.part2").text(match[2]):row.find("td.url span.part1").text(val.url),row.find("td.url").attr("title",val.url),$("#listTable").append(row)})):$("#listTable").html('<tr><td class="checkbox"></td><td class="url"><span class="part3">No links found on the page.</span></span></td><td class="Description"></td></tr>'),$("#listTable input.checkbox").change((function(){$(this).is(":checked")?$(this).parent().parent().addClass("green"):$(this).parent().parent().removeClass("green");var numberOfFiles=$("#listTable input.checkbox:checked").length;$("#startButtonCounter").text(numberOfFiles),numberOfFiles>0?$("#startButton").prop("disabled",!1):$("#startButton").prop("disabled",!0)})),$("#listTable tr.link").mousedown((function(){shift?selectEnd=$(this).index():(selectStart=$(this).index(),selectEnd=selectStart),selecting=!0,drawSelection()})),$("#listTable tr.link").mouseover((function(){selecting&&(selectEnd=$(this).index(),drawSelection())})),$(document).mouseup((function(){selecting=!1,drawSelection()})),drawSelection())}));var selecting=!1,selectStart=0,selectEnd=0;function drawSelection(){$("#listTable tr.link").each((function(i,el){i>=Math.min(selectStart,selectEnd)&&i<=Math.max(selectStart,selectEnd)?$(el).addClass("selected"):$(el).removeClass("selected")}))}var shift=!1;function globStringToRegex(str){return new RegExp(preg_quote(str).replace(/\\\*/g,".*").replace(/\\\?/g,"."),"g")}function preg_quote(str,delimiter){return(str+"").replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(delimiter||"")+"-]","g"),"\\$&")}$(document).on("keyup keydown",(function(e){shift=e.shiftKey})),$(document).keypress((function(e){if(32==e.keyCode){var allMarked=!0;return $("#listTable tr.link.selected").find("input.checkbox").each((function(i,el){$(el).is(":checked")||(allMarked=!1)})),$("#listTable tr.link.selected").find("input.checkbox").prop("checked",!allMarked).change(),!1}}));
//# sourceMappingURL=popup.min.js.map